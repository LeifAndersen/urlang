; #lang racket
; uncomment to test in Racket
(struct color (red green blue [alpha #:auto])
  #:auto-value 255 #:transparent)

(define (color->web-color color)
  (string-append "rgba("
                 (color-red   color) ","
                 (color-green color) ","
                 (color-blue  color) ","
                 (color-alpha color) ")"))

(define (string->web-color str)
  (color->web-color (string->color str)))

(define string->color
  (let ()
    (define *color-table* (make-hasheq))
    (define colors
      ; TODO: This is the short list.
      ;       The full list is below.
      '(["orange"               (255 165   0)]
        ["darkred"              (139   0   0)]
        ["red"                  (255   0   0)]
        ["lightpink"            (255 182 193)]
        ["pink"                 (255 192 203)]
        ["brown"                (132  60  36)]
        ["gold"                 (255 215   0)]
        ["yellow"               (255 255   0)]
        ["olive"                (128 128   0)]
        ["green"                (  0 255   0)]
        ["dark green"           (  0 100   0)]
        ["darkgreen"            (  0 100   0)]
        ["aquamarine"           (112 216 144)]
        ["lightgreen"           (144 238 144)]
        ["turquoise"            ( 64 224 208)]
        ["royalblue"            ( 65 105 225)]
        ["cyan"                 (  0 255 255)]
        ["aqua"                 (  0 255 255)]
        ["darkcyan"             (  0 139 139)]
        ["teal"                 (  0 128 128)]
        ["sky blue"             (135 206 235)]
        ["skyblue"              (135 206 235)]
        ["light blue"           (173 216 230)]
        ["lightblue"            (173 216 230)]
        ["lightcyan"            (224 255 255)]
        ["medium blue"          (  0   0 205)]
        ["mediumblue"           (  0   0 205)]
        ["darkblue"             (  0   0 139)]
        ["midnight blue"        ( 25  25 112)]
        ["midnightblue"         ( 25  25 112)]
        ["navy"                 ( 36  36 140)]
        ["blue"                 (  0   0 255)]
        ["indigo"               ( 75   0 130)]
        ["purple"               (160  32 240)]
        ["darkviolet"           (148   0 211)]
        ["mediumpurple"         (147 112 219)]
        ["magenta"              (255   0 255)]
        ["darkmagenta"          (139   0 139)]
        ["violet"               (238 130 238)]
        ["lavender"             (230 230 250)]
        ["white"                (255 255 255)]
        ["light gray"           (211 211 211)]
        ["lightgray"            (211 211 211)]
        ["silver"               (192 192 192)]
        ["gray"                 (190 190 190)]
        ["dark gray"            (169 169 169)]
        ["darkgray"             (169 169 169)]
        ["black"                (  0   0   0)])
      #;'(["orange"               (255 165   0)]
        ["orangered"            (255  69   0)]
        ["tomato"               (255  99  71)]
        ["darkred"              (139   0   0)]
        ["red"                  (255   0   0)]
        ["firebrick"            (178  34  34)]
        ["crimson"              (220  20  60)]
        ["deeppink"             (255  20 147)]
        ["maroon"               (176  48  96)]
        ["indian red"           (205  92  92)]
        ["indianred"            (205  92  92)]
        ["medium violet red"    (199  21 133)]
        ["mediumvioletred"      (199  21 133)]
        ["violet red"           (208  32 144)]
        ["violetred"            (208  32 144)]
        ["lightcoral"           (240 128 128)]
        ["hotpink"              (255 105 180)]
        ["palevioletred"        (219 112 147)]
        ["lightpink"            (255 182 193)]
        ["rosybrown"            (188 143 143)]
        ["pink"                 (255 192 203)]
        ["orchid"               (218 112 214)]
        ["lavenderblush"        (255 240 245)]
        ["snow"                 (255 250 250)]
        ["chocolate"            (210 105  30)]
        ["saddlebrown"          (139  69  19)]
        ["brown"                (132  60  36)]
        ["darkorange"           (255 140   0)]
        ["coral"                (255 127 80)]
        ["sienna"               (160  82  45)]
        ["salmon"               (250 128 114)]
        ["peru"                 (205 133  63)]
        ["darkgoldenrod"        (184 134  11)]
        ["goldenrod"            (218 165  32)]
        ["sandybrown"           (244 164  96)]
        ["lightsalmon"          (255 160 122)]
        ["darksalmon"           (233 150 122)]
        ["gold"                 (255 215   0)]
        ["yellow"               (255 255   0)]
        ["olive"                (128 128   0)]
        ["burlywood"            (222 184 135)]
        ["tan"                  (210 180 140)]
        ["navajowhite"          (255 222 173)]
        ["peachpuff"            (255 218 185)]
        ["khaki"                (240 230 140)]
        ["darkkhaki"            (189 183 107)]
        ["moccasin"             (255 228 181)]
        ["wheat"                (245 222 179)]
        ["bisque"               (255 228 196)]
        ["palegoldenrod"        (238 232 170)]
        ["blanchedalmond"       (255 235 205)]
        ["medium goldenrod"     (234 234 173)]
        ["mediumgoldenrod"      (234 234 173)]
        ["papayawhip"           (255 239 213)]
        ["mistyrose"            (255 228 225)]
        ["lemonchiffon"         (255 250 205)]
        ["antiquewhite"         (250 235 215)]
        ["cornsilk"             (255 248 220)]
        ["lightgoldenrodyellow" (250 250 210)]
        ["oldlace"              (253 245 230)]
        ["linen"                (250 240 230)]
        ["lightyellow"          (255 255 224)]
        ["seashell"             (255 245 238)]
        ["beige"                (245 245 220)]
        ["floralwhite"          (255 250 240)]
        ["ivory"                (255 255 240)]
        ["green"                (  0 255   0)]
        ["lawngreen"            (124 252   0)]
        ["chartreuse"           (127 255   0)]
        ["green yellow"         (173 255  47)]
        ["greenyellow"          (173 255  47)]
        ["yellow green"         (154 205  50)]
        ["yellowgreen"          (154 205  50)]
        ["medium forest green"  (107 142  35)]
        ["olivedrab"            (107 142  35)]
        ["mediumforestgreen"    (107 142  35)]
        ["dark olive green"     ( 85 107  47)]
        ["darkolivegreen"       ( 85 107  47)]
        ["darkseagreen"         (143 188 139)]
        ["lime"                 (  0 255   0)]
        ["dark green"           (  0 100   0)]
        ["darkgreen"            (  0 100   0)]
        ["lime green"           ( 50 205  50)]
        ["limegreen"            ( 50 205  50)]
        ["forest green"         ( 34 139  34)]
        ["forestgreen"          ( 34 139  34)]
        ["spring green"         (  0 255 127)]
        ["springgreen"          (  0 255 127)]
        ["medium spring green"  (  0 250 154)]
        ["mediumspringgreen"    (  0 250 154)]
        ["sea green"            ( 46 139  87)]
        ["seagreen"             ( 46 139  87)]
        ["medium sea green"     ( 60 179 113)]
        ["mediumseagreen"       ( 60 179 113)]
        ["aquamarine"           (112 216 144)]
        ["lightgreen"           (144 238 144)]
        ["pale green"           (152 251 152)]
        ["palegreen"            (152 251 152)]
        ["medium aquamarine"    (102 205 170)]
        ["mediumaquamarine"     (102 205 170)]
        ["turquoise"            ( 64 224 208)]
        ["lightseagreen"        ( 32 178 170)]
        ["medium turquoise"     ( 72 209 204)]
        ["mediumturquoise"      ( 72 209 204)]
        ["honeydew"             (240 255 240)]
        ["mintcream"            (245 255 250)]
        ["royalblue"            ( 65 105 225)]
        ["dodgerblue"           ( 30 144 255)]
        ["deepskyblue"          (  0 191 255)]
        ["cornflowerblue"       (100 149 237)]
        ["steel blue"           ( 70 130 180)]
        ["steelblue"            ( 70 130 180)]
        ["lightskyblue"         (135 206 250)]
        ["dark turquoise"       (  0 206 209)]
        ["darkturquoise"        (  0 206 209)]
        ["cyan"                 (  0 255 255)]
        ["aqua"                 (  0 255 255)]
        ["darkcyan"             (  0 139 139)]
        ["teal"                 (  0 128 128)]
        ["sky blue"             (135 206 235)]
        ["skyblue"              (135 206 235)]
        ["cadet blue"           ( 96 160 160)]
        ["cadetblue"            ( 95 158 160)]
        ["dark slate gray"      ( 47  79  79)]
        ["darkslategray"        ( 47  79  79)]
        ["lightslategray"       (119 136 153)]
        ["slategray"            (112 128 144)]
        ["light steel blue"     (176 196 222)]
        ["lightsteelblue"       (176 196 222)]
        ["light blue"           (173 216 230)]
        ["lightblue"            (173 216 230)]
        ["powderblue"           (176 224 230)]
        ["paleturquoise"        (175 238 238)]
        ["lightcyan"            (224 255 255)]
        ["aliceblue"            (240 248 255)]
        ["azure"                (240 255 255)]
        ["medium blue"          (  0   0 205)]
        ["mediumblue"           (  0   0 205)]
        ["darkblue"             (  0   0 139)]
        ["midnight blue"        ( 25  25 112)]
        ["midnightblue"         ( 25  25 112)]
        ["navy"                 ( 36  36 140)]
        ["blue"                 (  0   0 255)]
        ["indigo"               ( 75   0 130)]
        ["blue violet"          (138  43 226)]
        ["blueviolet"           (138  43 226)]
        ["medium slate blue"    (123 104 238)]
        ["mediumslateblue"      (123 104 238)]
        ["slate blue"           (106  90 205)]
        ["slateblue"            (106  90 205)]
        ["purple"               (160  32 240)]
        ["dark slate blue"      ( 72  61 139)]
        ["darkslateblue"        ( 72  61 139)]
        ["darkviolet"           (148   0 211)]
        ["dark orchid"          (153  50 204)]
        ["darkorchid"           (153  50 204)]
        ["mediumpurple"         (147 112 219)]
        ["cornflower blue"      ( 68  64 108)]
        ["medium orchid"        (186  85 211)]
        ["mediumorchid"         (186  85 211)]
        ["magenta"              (255   0 255)]
        ["fuchsia"              (255   0 255)]
        ["darkmagenta"          (139   0 139)]
        ["violet"               (238 130 238)]
        ["plum"                 (221 160 221)]
        ["lavender"             (230 230 250)]
        ["thistle"              (216 191 216)]
        ["ghostwhite"           (248 248 255)]
        ["white"                (255 255 255)]
        ["whitesmoke"           (245 245 245)]
        ["gainsboro"            (220 220 220)]
        ["light gray"           (211 211 211)]
        ["lightgray"            (211 211 211)]
        ["silver"               (192 192 192)]
        ["gray"                 (190 190 190)]
        ["dark gray"            (169 169 169)]
        ["darkgray"             (169 169 169)]
        ["dim gray"             (105 105 105)]
        ["dimgray"              (105 105 105)]
        ["black"                (  0   0   0)]))
    (for ([x (in-list colors)])
      (define name (first x))
      (define rgb  (second x))
      (define-values (r g b) (values (first rgb) (second rgb) (third rgb)))
      (hash-set! *color-table* (string->symbol (first x)) (color r g b)))
    (λ (color-string)
      (hash-ref *color-table* (string->symbol (string-downcase color-string))))))
